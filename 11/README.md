# CPU 스케줄링
## CPU 스케줄링 개요
운영체제가 프로세스들에게 공정하고 합리적으로 CPU 자원을 배분하는 것

### 프로세스 우선순위
프로세스의 중요도에 맞게 프로세스가 CPU를 이용할 수 있도록 하기 위해 운영체제는 프로세스마다 우선순위를 부여

우선순위가 높은 프로세스를 먼저 처리 ex. 입출력 작업

- 입출력 집중 프로세스I/O bound process: 비디오 재생이나 디스크 백업 작업을 담당하는 프로세스
- CPU 집중 프로세스CPU bound process: 복잡한 수학 연산, 컴파일, 그래픽 처리 작업을 담당하는 프로세스

CPU를 많이 사용해야하는 CPU 집중 프로세스를 입출력 집중 프로세스와 동일한 빈도로 CPU를 사용하는 것은 비합리적

입출력 집중 프로세스를 가능한 한 빨리 실행시켜 대기 상태로 만들고, CPU 집중 프로세스에 집중적으로 CPU를 할당

### 스케줄링 큐
운영체제는 프로세스들을 스케줄링 큐scheduling queue로 구현하고 관리하며 줄 세움

메모리로 적재되고 싶은 프로세스들을 큐에 삽입하여 줄을 세우고, CPU를 이용하고 싶은 프로세스들 또한 큐에 삽입하여 줄을 세우고, 특정 입출력장치를 이용하고 싶은 프로세스들 역시 큐에 삽입하여 줄 세움

운영체제가 관리하는 대부분의 자원은 큐로 관리됨

- 준비 큐ready queue: CPU를 이용하고 싶은 프로세스들이 서는 줄
- 대기 큐waiting queue: 입출력장치를 이용하기 위해 대기 상태에 접어든 프로세스들이 서는 줄

운영체제는 PCB들이 큐에 삽입된 순서대로 프로세스를 하나씩 꺼내어 실행하되, 그 중 우선순위가 높은 프로세스를 먼저 실행

### 선점형과 비선점형 스케줄링
- 선점형 스케줄링preemptive scheduling: 프로세스가 CPU를 비롯한 자원을 사용하고 있더라도 운영체제가 프로세스로부터 자원을 강제로 빼앗아 다른 프로세스에 할당할 수 있는 스케줄 방식
- 비선점형 스케줄링non-preemptive scheduling: 하나의 프로세스가 자원을 사용하고 있다면 그 프로세스가 종료되거나 스스로 대기 상태에 접어들기 전까진 다른 프로세스가 끼어들 수 없는 스케줄링 방식

## CPU 스케줄링 알고리즘
### 스케줄링 알고리즘의 종류
#### 선입 선처리 스케줄링, FCFS 스케줄링(First Come Fisrt Served Scheduling)
단순히 준비 큐에 삽입된 순서대로 프로세스들을 처리하는 비선점형 스케줄링
대기 시간이 단순히 증가하는 호위 효과convoy effect

#### 최단 작업 우선 스케줄링, SJF 스케줄링(Sortest Job Fist Scheduling)
준비 큐에 삽입된 프로세스들 중 CPU 이용시간의 길이가 가장 짧은 프로세스부터 실행하는 스케줄링 방식

#### 라운드 로빈 스케줄링round robin scheduling
선입 선처리 스케줄링에 각 프로세스가 CPU를 사용할 수 있는 정해진 시간인 타임 슬라이스 개념이 더해진 스케줄링 방식

정해진 타임 슬라이스만큼의 시간 동안 돌아가며 CPU를 이용하는 선점형 스케줄링

#### 최소 잔여 시간 우선 스케줄링, SRT 스케줄링(Shortest Remaining Time)
최단 작업 우선 스케줄링 알고리즘과 라운드 로빈 알고리즘을 합친 스케줄링 방식

최소 잔여 시간 우선 스케줄링 하에서 프로세스들은 정해진 타임 슬라이스만큼 CPU를 사용하되, CPU를 사용할 다음 프로세스로는 남아있는 작업 시간이 가장 적은 프로세스가 선택됨

#### 우선순위 스케줄링
프로레스들에 우선순위를 부여하고, 가장 높은 우선순위를 가진 프로세스부터 실행하는 스케줄링 알고리즘

우선순위가 낲은 프로세스가 계속해서 연기될 수 있는 기아 현상starvation 가능성이 있음

=> 오랫동안 대기한 프로세스의 우선순위를 점차 높이는 에이징aging

#### 다단계 큐 스케줄링
우선순위별로 준비 큐를 여러 개 사용하는 스케줄링 방식

우선순위가 가장 높은 큐에 있는 프로세스들을 먼저 처리하고, 우선순위가 가장 높은 큐가 비어 있으면 그다음 우선순위 큐에 있는 프로세스들을 처리

큐를 여러개 두며 프로세스 유형별로 우선순위를 구분하여 실행하는 것이 편리해짐

큐별로 타임 슬라이스를 여러 개 지정할 수도 있고, 큐마다 다른 스케줄링 알고리즘을 사용할 수도 있음

#### 다단계 피드백 큐 스케줄링
다단계 큐 스케줄링의 발전된 현태로, 프로세스들이 큐 사이를 이동할 수 있어 기아 현상을 방지할 수 있음

새로 준비 상태가 된 프로세스가 있다면 우선 순위가 가장 높은 우선순위 큐에 삽입되고 타임 슬라이스동안 실행됨. 해당 큐에서 실행이 끝나지 않는다면 다음 우선순위 큐에 삽입되어 실행되며 CPU를 오래 사용해야 하는 프로세스는 점차 우선순위가 낮아짐

CPU를 비교적 오래 사용해야 하는 CPU 집중 프로세스들은 자연스레 우선순위가 낮아지고, CPU를 비교적 적게 사용하는 입출력 집중 프로세스들은 자연스레 우선순위가 높은 큐에서 실행이 끝남

낮은 우선순위 큐에서 너무 오래 기다리고 있는 프로세스가 있다면 점차 우선순위가 높은 큐로 이동시키는 에이징 기법을 적용하여 기아 현상 예방 가능

즉, 어떤 프로세스의 CPU 이용 시간이 길면 낮은 우선순위 큐로 이동시키고, 어떤 프로세스가 낮은 우선순위 큐에서 너무 오래 기다린다면 높은 우선순위 큐로 이동시킬 수 있는 알고리즘
